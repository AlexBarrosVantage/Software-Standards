<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en">
<title>Never use gets() function</title>
<link rel="StyleSheet" href="../../style.css" type="text/css">
</head>
<body>
<h4>Never use gets() function</h4>
<hr>
<h5>Technology</h5>
<p>C Language, C++</p>
<h5>Unified Status</h5>
<p>Unified</p>
<h5>XXL Status</h5>
<p>N/A</p>
<h5>Critical Quality Rule</h5>
<p>No</p>
<h5>Weight in Parent Tech. Criterion</h5>
<p>7</p>
<h5>Rationale</h5>
<p>The &#39;gets()&#39; function reads characters until a newline is encountered and stores them into a string buffer. This function is intrinsically unsafe and should not be used because it is not possible to specify the size of the string buffer. This can lead to buffer overflows.</p>
<h5>Description</h5>
<p>This rule searches for C/C++ functions, methods, constructors, and destructors that call the &#39;gets()&#39; function.</p>
<h5>Remediation</h5>
<p>In C code, replace &#39;gets()&#39; function calls with &#39;fgets(buf, sizeof(buf), stdin)&#39;. If the string buffer has been statically defined, then use &#39;sizeof(buf)-1&#39; in the &#39;fgets()&#39; function. In C++ code, use input stream instead and specify the number of characters to be
read.</p>
<h5>Reference</h5>
<p>Build Security In (https://buildsecurityin.us-cert.gov/bsi/articles/knowledge/coding)</p>
<h5>Sample</h5>
<pre>
void foo()
{
  char strbuf[10];
  gets(strbuf);
}
</pre>
<h5>Remediation sample</h5>
<pre>
void foo()
{
  char strbuf[10];
  fgets(strbuf, sizeof(strbuf)-1, stdin);
}
</pre>
<h5>Output</h5>
<p>Associated to each C/C++ function/method/constructor/destructor with violations, the Quality Rule provides: - Number of violation patterns - Bookmarks for violation patterns found in the source code: - function call</p>
<h5>Total</h5>
<p>Number of C/C++ functions, constructors, destructors, and methods</p>
<h5>Metric ID</h5>
<p>7976</p>
<hr>
<p align="right"><a href="http://www.castsoftware.com" target="_blank"><img border="0" src="../../cast.gif" alt="CAST Website" width="174" height="21"></a></p>
</body>
</html>
