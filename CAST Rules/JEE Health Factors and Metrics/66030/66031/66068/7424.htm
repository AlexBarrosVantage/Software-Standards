<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta http-equiv="Content-Language" content="en">
<title>Avoid using SQL queries inside a loop</title>
<link rel="StyleSheet" href="../../../style.css" type="text/css">
</head>
<body>
<h4>Avoid using SQL queries inside a loop</h4>
<hr>
<h5>Technology</h5>
<p>All Languages/Technologies</p>
<h5>Unified Status</h5>
<p>N/A</p>
<h5>XXL Status</h5>
<p>N/A</p>
<h5>Critical Quality Rule</h5>
<p>Yes</p>
<h5>Weight in Parent Tech. Criterion</h5>
<p>7</p>
<h5>Rationale</h5>
<p>Having an SQL query inside a loop is usually the source of performance and scalability problems especially if the number of iterations become very high (for example if it is dependent on the data returned from the database). This iterative pattern has proved to be very dangerous for application
performance and scalability. Database servers handle in a much better set-oriented pattern rather than pure iterative ones.</p>
<h5>Description</h5>
<p>This metric retrieves all artifacts using at least one SQL query inside a loop statement.</p>
<h5>Remediation</h5>
<p>The remediation is often to replace the iterative approach based on a loop with a set-oriented one and thus modify the query.</p>
<h5>Sample</h5>
<pre>
PreparedStatement updateSales;
String updateString = &quot;update COFFEES &quot; +
                      &quot;set SALES = ? where COF_NAME like ?&quot;;
updateSales = con.prepareStatement(updateString);

int len = coffees.length;
for(int i = 0; i &lt; len; i++) {
                updateSales.setInt(1, salesForWeek[i]);
                updateSales.setString(2, coffees[i]);
                updateSales.executeUpdate();    // VIOLATION
        }
</pre>
<h5>Output</h5>
<p>Associated to each client-server artifact with violations, the Quality Rule provides: - Number of violation patterns - Bookmarks for violation patterns found in the source code: - SQL query - loop starting line</p>
<h5>Total</h5>
<p>Number of client-server artifacts using tables and views</p>
<h5>Metric ID</h5>
<p>7424</p>
<hr>
<p align="right"><a href="http://www.castsoftware.com" target="_blank"><img border="0" src="../../../cast.gif" alt="CAST Website" width="174" height="21"></a></p>
</body>
</html>
